---
import InstallBtn from "./view/components/InstallBtn.astro";

export interface Props {
  btnText?: string;
  btnBackground?: string;
  hideSvg?: boolean;
}

const { btnText, btnBackground, hideSvg } = Astro.props as Props;
---

<script>
  import pwaSettings from "../pwa.config.json";
  import runPWASetup from "./view/utils/PWASetup";
  import { isPWAInstalled } from "./view/utils/utilities";

  window.addEventListener("DOMContentLoaded", () => {
    const isShowBtn = pwaSettings.isInstallBtnVisible && pwaSettings?.isManifest;
    const isInstalled = isPWAInstalled();
    const pwaBtn = document.getElementById("install");
    if (isInstalled && pwaBtn) pwaBtn.parentNode?.removeChild(pwaBtn);
    runPWASetup(isShowBtn);
  });
</script>

<InstallBtn btnText={btnText} btnBackground={btnBackground} hideSvg={hideSvg} />
