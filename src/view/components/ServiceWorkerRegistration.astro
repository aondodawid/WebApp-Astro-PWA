<script is:inline>
  import pwaSettings from "../../../pwa.config.json";

  const registerSW = async () => {
    if ("serviceWorker" in navigator) {
      try {
        const registration = await navigator.serviceWorker.register("/sw.js");
        console.log("Service Worker Registered");
      } catch (err) {
        console.log(
          "Some error occurred while checking service worker registration",
        );
        console.log(err);
      }
    } else throw new Error("Service Worker is not supported in this browser");
  };
  window.addEventListener("load", registerSW);

  if(pwaSettings?.forceUpdate) {
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then(registrations => {
        for (const registration of registrations) {
          registration.update(); // Forces the browser to check for an updated sw.js
        }
      });
    }
  }
</script>
